# 6. 代理构建方法

## 6.1 数据架构
代理的可信度取决于其数据基础。我们采用“三层架构”来组织画像素材：

- **行为层（Behavior Layer）**：收集浏览、购买、交互日志等客观记录，标注时间戳、渠道与语境标签，形成代理的“外显经验”。这些数据能够回答“TA 做过什么”。
- **内容层（Content Layer）**：整合用户生成的文本、音频、视频、社交档案与评论，使代理在对话中呈现真实的语言风格与兴趣表达。它们描述“TA 如何阐述自己”。
- **认知层（Cognition Layer）**：包含问卷、访谈、价值观陈述、决策树等主观信息，揭示代理的动机与判断准则，回答“TA 为什么这样想”。

每一次画像更新都需记录来源、时间与可信度。当数据缺口明显时，可在画像中显式标注假设与合成数据的比例，确保后续分析与治理环节能够追溯依据。

## 6.2 构建准则
为了让画像成为可长期维护的“代理资产”，需要遵循三条原则：

1. **完整性（Completeness）**：在收集单一数据源之前确认其与三层架构的映射关系，必要时使用合成数据补齐，但必须标记假设与验证计划。
2. **一致性（Consistency）**：当行为记录与调研陈述出现矛盾时，应在代理的版本说明中记录冲突来源，并决定是维持多重人格假设还是进行人工调和。
3. **演化性（Evolvability）**：为代理设定更新节奏（如季度、项目归档或事件触发），并借助版本控制记录变更，使代理能在不同模拟项目中复用并持续成长。

## 6.3 三层架构
| 层级（Layer） | 核心职能（Function） | 交付物（Deliverable） |
| :--- | :--- | :--- |
| 策略层（Strategic） | 定义模拟目标、场景边界与成功指标 | 场景说明书、目标矩阵 |
| 认知层（Cognitive） | 构建代理特质、记忆与推理路径 | 人物卡、动机图谱、提示模板 |
| 交互层（Interactive） | 承载对话、行为演绎与反馈记录 | 对话脚本、行为日志、事件回放 |

三层架构确保策略目标、认知设定与交互实现之间形成闭环。

## 6.4 系统角色与能力栈
除了主体代理，我们还需要明确定义配套角色：

| 系统角色 | 职责摘要 | 关键能力 | 典型输出 |
| :--- | :--- | :--- | :--- |
| 主控代理（Orchestrator） | 统筹流程、调用工具、触发评估 | 规划、调度、质量把控 | 流程日志、评估指令、复盘纪要 |
| 情境代理（Backdrop） | 维护环境参数、规则与背景事件 | 场景设定、事件触发、变量管理 | 场景设定表、事件脚本、约束清单 |
| 主体代理（Persona） | 代表真实用户群体参与互动 | 记忆管理、推理、情绪呈现 | 对话、决策记录、情绪轨迹 |
| 评估代理（Evaluator） | 审查结果、输出指标与建议 | 指标计算、异常侦测、反馈生成 | 审核报表、风险提示、纠偏建议 |

能力域与章节对应关系如下：

| 能力域（Capability） | 所属代理 | 关键要素 | 对应章节 |
| :--- | :--- | :--- | :--- |
| 记忆与背景 | 主体代理 | 生平、偏好、来源标签 | 第 3 章、第 6 章 |
| 推理与判断 | 主控/主体 | 决策框架、启发式、阈值 | 第 4 章、第 7 章 |
| 行为脚本 | 交互层代理 | 行为序列、分支条件 | 第 7 章 |
| 评估与反馈 | 评估代理 | 成功指标、风险提示 | 第 8、9 章 |

## 6.5 原型库与版本管理
建立可复用的“代理原型库”能够提升组织效率。建议在库中区分三类代理：

- **核心代理（Core Personas）**：如 Aurora、Maxwell、Sage，覆盖产品、市场、数据三大核心视角。
- **支撑代理（Supporting Personas）**：如 Evelyn、Noah、Li Wei，提供体验、商业与文化补充。
- **过程代理（Process Agents）**：如 Moderator-B、Observer-C、Auditor-D，确保流程与质量。

对于每个代理，需要维护来源说明、有效期、适用场景、使用次数、风险提示等元数据。当项目引入新行业或需要治理建议时，可启用扩展槽位，并在版本说明中记录触发条件与退出标准。所有更新都应记录在案，方便后续项目追溯知识演化。
