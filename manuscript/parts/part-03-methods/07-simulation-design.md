# 7. 模拟设计方法（Simulation Design）

## 7.1 场景构建（Scenario Construction）
模拟的第一步是把业务问题转化为可执行的场景蓝图：

1. **环境设定（Environment Setup）**：明确时间、地点、参与角色及触发事件。需要区分可控变量（如价格、文案、流程）与不可控变量（如天气、突发舆情），并在情境代理中配置相应参数。
2. **任务设计（Task Design）**：将业务目标拆解为代理能够理解的任务，如“选择是否购买”“对文案提供反馈”“在对话中表达疑虑”。同时要给出成功判定标准（KPIs）与约束条件（时间限制、预算上限、信息噪音等）。
3. **激励机制（Incentive Design）**：构建奖励、惩罚与反馈通道，让代理的行为具备现实动机。例如可在提示中设定“获得折扣”“失去积分”等激励，并记录它们对决策的影响。

完整的场景构建通常需要配套的"场景说明书"与"目标矩阵"，以便后续团队复用。

## 7.2 交互设计（Interaction Design）
设计交互时需要明确“谁与谁互动”“如何互动”：

- **单体交互（Agent-to-Environment）**：代理与环境进行对话或操作时，必须确保提示中包含必要背景，且在每轮交互后更新代理记忆，以便后续分析。
- **群体交互（Agent-to-Agent）**：当多个代理协作、竞争或对抗时，应使用网络结构或回合制机制管理信息流，避免提示冲突。可在日志中记录影响力指标、意见传播路径等。
- **混合交互（Agent-to-Human）**：若项目需要真人参与（如设计师、客服、用户代表），需要明确节奏、权限与安全边界。建议使用“Moderator-B” 负责调度，确保所有输入输出都被记录并遵循隐私合规。

## 7.3 过程管理（Process Management）
模拟是一个不断运行的过程，必须有完善的过程管理机制：

- **轨迹记录（Trajectory Logging）**：为代理的每次决策记录输入、输出、引用与备选方案，形成可回放的决策树。
- **状态追踪（State Tracking）**：监控代理的内部变量（如情绪、信念、信心值）、外部指标（如任务完成度、资源消耗）。
- **数据采集（Data Capture）**：使用统一的日志 schema、主键与标签，方便跨项目对比。建议在日志中包含"场景 ID、代理 ID、回合数、触发事件、评估标签"等字段，并与评估代理的输出打通。

> **实践提示**：在实际项目中，可先使用"小场景快速试运行"的方式验证脚本与提示，再扩展到大规模模拟。
